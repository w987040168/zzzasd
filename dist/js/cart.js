"use strict";$(function(){if(!getCookie("nickname"))return window.location.href="../pages/index.html";var o=JSON.parse(window.localStorage.getItem("cart"))||[];if(!o.length)return $(".noShopping").addClass("active"),void $(".shopping").removeClass("active");function s(){var n=o.every(function(n){return 1==n.is_select}),i=0,s=0;o.forEach(function(n){"1"===n.is_select&&(i+=+n.cart_number,s+=n.cart_number*n.goods_price)});var a='\n            <div class="shopping-header">\n                <div class="shopping-header-info">\n                    <div class="el-checkbox">\n                        <span>\n                            <input type="checkbox" '.concat(n?"checked":"",'>\n                        </span>\n                        <span>全选</span>\n                    </div>\n                    <span class="text">商品信息</span>\n                </div>\n                <div class="shopping-header-unitPrice">\n                    <span>单价</span>\n                </div>\n                <div class="shopping-header-num">\n                    <span>数量</span>\n                </div>\n                <div class="shopping-header-xiaoji">\n                    <span>小计</span>\n                </div>\n                <div class="shopping-header-caozuo">\n                    <span>操作</span>\n                </div>\n             </div>\n        ');o.forEach(function(n){a+='\n            <div class="shopping-list">\n                <div class="shopping-list-item">\n                    <div class="p-info">\n                        <input data-id="'.concat(n.goods_id,'" type="checkbox" ').concat(0==n.is_select?"":"checked",'>\n                        <span>\n                            <img src="').concat(n.goods_small_logo,'" alt="">\n                        </span>\n                        <div class="item-text">\n                            <span>\n                                ').concat(n.goods_name,'\n                            </span>\n                            <span>\n                                智能防夹须 / 增加50%接触面 / 智能充电显示\n                            </span>\n                        </div>\n                    </div>\n                    <div class="p-price">\n                        ￥').concat(n.goods_price,'\n                    </div>\n                    <div class="p-asBox">\n                        <span class="subNum" data-id="').concat(n.goods_id,'">-</span>\n                        <input type="text" value="').concat(n.cart_number,'">\n                        <span class="addNum" data-id="').concat(n.goods_id,'">+</span>\n                        \n                    </div>\n                    <div class="p-zj">\n                        ￥').concat(n.goods_price,'\n                    </div>\n                    <div class="p-cz">\n                        <span class="del" data-id="').concat(n.goods_id,'">\n                            删除\n                        </span>\n                    </div>\n                </div>\n            </div>\n        ')}),a+='\n        <div class="shopping-bottom">\n                <div class="shopping-bottom-left">\n                    <div class="br-info">\n                        \n                        <span class="clearBox">批量删除</span>\n                    </div>\n                </div>\n                <div class="shopping-bottom-right">\n                    <span>应付金额</span>\n                    <span>￥'.concat(s.toFixed(2),"</span>\n                    <button><span> 结算 ( ").concat(i," )</span></button>\n                </div>\n            </div>\n        "),$(".shopping").html(a)}console.log(o),$(".shopping").addClass("active"),$(".noShopping").removeClass("active"),s(),$(".shopping").on("click",".p-info input",function(){var n=this.checked,i=$(this).data("id");o.filter(function(n){return n.goods_id==i})[0].is_select=n?"1":"0",s(),window.localStorage.setItem("cart",JSON.stringify(o))}),$(".shopping").on("click",".addNum",function(){var i=$(this).data("id"),n=o.filter(function(n){return n.goods_id==i})[0];n.cart_number=+n.cart_number+1,s(),window.localStorage.setItem("cart",JSON.stringify(o))}),$(".shopping").on("click",".subNum",function(){var i=$(this).data("id"),n=o.filter(function(n){return n.goods_id==i})[0];1!==n.cart_number&&(n.cart_number=+n.cart_number-1,s(),window.localStorage.setItem("cart",JSON.stringify(o)))}),$(".shopping").on("click",".del",function(){for(var n=$(this).data("id"),i=0;i<o.length;i++)if(o[i].goods_id==n){o.splice(i,1);break}if(s(),window.localStorage.setItem("cart",JSON.stringify(o)),!o.length)return window.location.reload()}),$(".shopping").on("click",".el-checkbox  input",function(){if(this.checked)for(var n=0;n<o.length;n++)o[n].is_select=1,window.localStorage.setItem("cart",JSON.stringify(o));else for(var i=0;i<o.length;i++)o[i].is_select=0,window.localStorage.setItem("cart",JSON.stringify(o));s()}),$(".shopping").on("click",".clearBox",function(){o.length=0,window.localStorage.setItem("cart",JSON.stringify(o)),window.location.reload()})});